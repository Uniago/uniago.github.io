---
title: 可变长子网掩码
date: 2023-11-19 01:15:51 +0800
categories: ['Tech', 'Network']
tags: ['网络', '子网掩码', 'IP地址']
math: true
---

## IP地址

> [可参考wiki](https://zh.wikipedia.org/zh-hans/IP%E5%9C%B0%E5%9D%80)

**点分十进制**

4个字节, 每个字节8个比特,共32位,可表示范围为0 ~ 255

| 进制 | 第一个字节 | 第二个字节 | 第三个字节 | 第四个字节 |
| -- | -- | -- | -- | -- |
| 十进制 | 192. | 168. | 10. | 1 |
| 二进制 | 11000000 | 10101000 | 00001010 | 00000001|

### IP地址分类

网络号 + 主机号

| 分类 | 范围 | 网络标志位 | 网络/主机 | 网络/主机 | 网络/主机 |
| -- | -- | -- | -- | -- | -- |
| A类 | 1~126 | 0NNNNNNN | Host | Host | Host |
| B类 | 128~191 |10NNNNNN | Network | Host | Host |
| C类 | 192~223 |110NNNNN | Network | Network | Host |
| D类 | 224~239 |1110NNNN | 不可分配 | 不可分配 | 不可分配 |
| E类 | 240~255 |11110NNN | 不可分配 | 不可分配 | 不可分配 |

#### IP地址类型

 通信类型: 单播, 组播, 广播

- 网络地址: 指代网络的地址,在网络的IPv4地址范围内,最小地址保留位网络地址.此地址的主机部分的每个主机位均为0
- 主机地址:分配给网络中终端设备的地址
- 广播地址: 用于向网络中的所有主机发送数据的特殊地址.广播地址使用该网络范围内的最大地址.即主机位全部为1的地址

#### 特殊IP

| IP地址 | 说明 |
| -- | -- |
| 0.0.0.0 | 所有ip,本网络 |
| 127.0.0.0 | 本机ip,本地环回 |

##### 0.0.0.0

IP地址为**0.0.0.0**，在计算机网络中具有两种含义

- 在服务器中，0.0.0.0指的是本机上的所有IPV4地址。如果一个主机有两个IP地址，192.168.1.1 和10.1.2.1，并且该主机上的一个服务监听的地址是0.0.0.0,那么通过两个ip地址都能够访问该服务。
- 在路由中，0.0.0.0表示的是默认路由，即当路由表中没有找到完全匹配的路由的时候所对应的路由。当数据包在路由器之间转发时，如果在路由表中没有找到目的IP所在的网段，就会发到目标IP为0.0.0.0的网关处。

##### 127开头的IP地址

127开头的IP地址都是特殊地址，称为“本地回环地址”。这些地址是保留的，不能用于互联网

127开头的IP地址包括：

- 127.0.0.1：最常用的本地回环地址，也称为“localhost”。
- 127.0.0.0：表示本地回环网络。
- 127.255.255.255：表示本地回环广播地址。


### IP地址的类别

- 共有 /私有地址

A类私有: 10.0.0.0 ~ 10.255.255.255(10.0.0.0/8)

B类私有: 172.16.0.0 ~ 172.31.255.255(172.16.0.0/12)

C类私有: 192.168.0.0 ~ 192.168.255.255(192.168.0.0/16)

> 与特殊地址不同,私有地址只是不能用于互联网通信，但是他依旧属于局域网地址。在同一个局域网内，其他设备能够访问这个 IP 地址。
{: .prompt-tip }

## 子网掩码


| 类型 | 第一个字节 | 第二个字节 | 第三个字节 | 第四个字节 |
| -- | -- | -- | -- | -- |
| 子网 | 172. | 16. | 10. | 0 |
| 掩码 | 255. | 255. | 0. | 0 |
| 说明 | Network | Network | Host | Host |

子网掩码表示为`172.16.10.0/16`

172为B类地址,默认前两个字节为网络部分,后两个字节为主机部分,后跟的16代表网络部分的掩码的位数(16个1),即`255.255.0.0`

**举个例子**

> 子网: 172.16.0.0
> 掩码: 255.255.0.0
> 主机范围: 172.16.0.0 ~ 172.16.255.255

简写为`172.16.0.0/16`, 这里没有划分,只有一个子网,该网络拥有$2^{16} - 2$个可用IP


### 划分方法

1. 判断类别,找默认掩码
2. 变更掩码,找子网
3. 得出子网号
4. 得出主机段
5. 得出广播号

子网划分时,借了m位,有$2^m$个子网;假设剩余主机位数为n,则每个子网有$2^{n-m} -2$个可用IP

**举个例子**

- 计算子网个数

B类掩码为19,借了3位,则$2^3$,即8个子网

- 计算子网主机数量(可用ip)

B类掩码位19,借了3位,剩余主机位为$16 - 3$个二进制位, $2^{13} - 2$个可用IP

### 子网划分

`172.16.0.0/16` -> `172.16.0.0/17` 掩码向右移动一位,会划分为**2个子网,每个子网拥有$2^{15} - 2$个可用IP**

第三个字节分别为`00000000`,`10000000`

- 172.16.0.0/17
- 172.16.128.0/17

**第一个子网`172.16.0.0/17`**

> 子网: 172.16.0.0
> 掩码: 255.255.128.0
> 主机范围: 172.16.0.0 ~ 172.16.127.255

简写为`172.16.0.0/17`, B类地址默认掩码位为16,这里的17相当于主机号向右移动1位, 该子网有$2^{15} - 2$个可用ip

| 类型 | 第一个字节 | 第二个字节 | 第三个字节 | 第四个字节 |
| -- | -- | -- | -- | -- |
| 子网 | 172. | 16. | 0. | 0 |
| 掩码 | 255. | 255. | 0. | 0 |
| 二进制 | 10101100 | 00010000 | 00000000 | 00000000 |

**第二个子网**`172.16.128.0/17`

> 子网: 172.16.128.0
> 掩码: 255.255.128.0
> 主机范围: 172.16.128.1 ~ 172.16.255.254

简写为`172.16.128.0/17`, B类地址默认掩码位为16,这里的17相当于主机号向右移动1位, 该子网有$2^{15} - 2$个可用ip

| 类型 | 一段 | 二段 | 三段 | 四段 |
| -- | -- | -- | -- | -- |
| 子网 | 172. | 16. | 128. | 0 |
| 掩码 | 255. | 255. | 128. | 0 |
| 二进制 | 10101100 | 00010000 | 10000000 | 00000000 |


----
### 举个例子

172.16.0.0/18如何划分子网?

172.16.192.0/18,B类地址默认掩码位为16,18相当于主机号向右移动2位

分别为`00000000`,`01000000`,`10000000`,`11000000`, **可划分为4个子网,每个子网有$2^{14} - 2$个可用IP**

- 172.16.0.0/18
- 172.16.64.0/18
- 172.16.128.0/18
- 172.16.192.0/18

**第一个子网`172.16.0.0/18`**

| 类型 | 第一个字节 | 第二个字节 | 第三个字节 | 第四个字节 |
| -- | -- | -- | -- | -- |
| IP地址 | 172. | 16. | 0. | 0 |
| 子网掩码 | 255. | 255. | 0. | 0 |
| 二进制 | 10101100 | 00010000 | 00000000 | 00000000 |

**第二个子网`172.16.64.0/18`**

| 类型 | 第一个字节 | 第二个字节 | 第三个字节 | 第四个字节 |
| -- | -- | -- | -- | -- |
| IP地址 | 172. | 16. | 64. | 0 |
| 子网掩码 | 255. | 255. | 64. | 0 |
| 二进制 | 10101100 | 00010000 | 01000000 | 00000000 |

**第三个子网`172.16.128.0/18`**

| 类型 | 第一个字节 | 第二个字节 | 第三个字节 | 第四个字节 |
| -- | -- | -- | -- | -- |
| IP地址 | 172. | 16. | 128. | 0 |
| 子网掩码 | 255. | 255. | 128. | 0 |
| 二进制 | 10101100 | 00010000 | 10000000 | 00000000 |

**第四个子网`172.16.192.0/18`**

| 类型 | 第一个字节 | 第二个字节 | 第三个字节 | 第四个字节 |
| -- | -- | -- | -- | -- |
| IP地址 | 172. | 16. | 192. | 0 |
| 子网掩码 | 255. | 255. | 192. | 0 |
| 二进制 | 10101100 | 00010000 | 11000000 | 00000000 |


